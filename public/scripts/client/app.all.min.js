"use strict";!function(a,e,s){s(function(){function a(a){var e=s(".private-chat-wrapper .private-chat-list .private-chat.active");return!!(e&&(e.removeClass("active"),a&&s(a).is(e)))}function t(a,e){if(e)e.hasClass("active")||(e.hasClass("new-message")&&e.removeClass("new-message"),e.addClass("active")),e.find("input").focus();else{var t=s('.private-chat-wrapper .private-chat-list .private-chat[data-socket-id="'+a+'"]');t.length&&(t.hasClass("active")||(t.hasClass("new-message")&&t.removeClass("new-message"),t.addClass("active")),t.find("input").focus())}}function i(a){var e=s('.private-chat-wrapper .private-chat-list .private-chat[data-socket-id="'+a+'"]');e.length&&(e.hasClass("active")||e.addClass("new-message"))}function r(a,e){var s='<li class="private-message"> <div class="username">'+a+"</div>"+e+"</li>";return s}function n(a,e){var s="";return s='<li data-socket-id="'+a+'" class="private-chat"> \n                        <span class="user-name">\n                            '+e+'\n                        </span> \n                        <div class="user-text">\n                            <ul class="private-messages-wrapper">\n                            </ul>\n                            <div class="input-field">\n                                <input class="message private-chat-send" type="text" placeholder="Your message..">\n                            </div>\n                        </div> \n                    </li>'}function c(a){var e="<li data-socket-id="+a._id+' class="user center-align">'+a._username+"</li>";u.append(e)}function p(a){s("li.user").remove('[data-socket-id="'+a._id+'"]')}var o=e(),v={id:"",username:""},l=!1,d=s("#message-wrapper"),u=s("#socket-users"),m=s(".input-message"),h=s("#chat-message"),f=s("#chat-message-send"),g=s(".input-username"),w=s("#username"),k=s("#set-username"),C=s(".private-chat-list"),x="";o.on("connect",function(){v.id=this.id}),o.on("chat-room-message",function(a){var e='<li class="message"><span class="user-name">'+a.username+"</span><p>"+a.message+"</p></li>";d.append(e)}),o.on("users-list",function(a){a.forEach(function(a){c(a)})}),o.on("user-joined",function(a){c(a)}),o.on("user-left",function(a){p(a)}),o.on("private-message",function(a){var e=s('.private-chat-wrapper .private-chat-list .private-chat[data-socket-id="'+a.from.id+'"]');if(0==e.length){var t=n(a.from.id,a.from.username);s(".private-chat-list").append(t),i(a.from.id);var c=s('.private-chat-wrapper .private-chat-list .private-chat[data-socket-id="'+a.from.id+'"]'),p=c.find(".private-messages-wrapper"),o=r(a.from.username,a.msg);p.append(o)}else{i(a.from.id);var v=e.find(".private-messages-wrapper"),l=r(a.from.username,a.msg);v.append(l)}}),f.on("click",function(){o.emit("chat-room-message",{username:v.username,message:h.val()}),h.val("")}),k.on("click",function(){v.username=w.val(),w.val(""),o.emit("user-joined",v.username),g.addClass("hide"),m.removeClass("hide"),l=!0}),s(".private-chat-wrapper .private-chat-list").on("click",".private-chat",function(){var e=this;a(e)||(t(null,s(this)),x=s(this).attr("data-socket-id"))}),s(".private-chat-wrapper .private-chat-list").on("click",".private-chat .user-text",function(a){x=s(this).parents(".private-chat").attr("data-socket-id"),a.stopPropagation()}),s("#socket-users").on("click","li",function(){if(l){var e=s(this).attr("data-socket-id");x=e;var i=s(this).text(),r=s('.private-chat-wrapper .private-chat-list .private-chat[data-socket-id="'+e+'"]');if(a(),0==r.length){var c=n(e,i);C.append(c),t(e)}else t(null,r)}}),C.on("keydown",".private-chat-send",function(a){if(13==a.keyCode){var e=s(this).val(),t=s(this).parents(".user-text"),i=t.find(".private-messages-wrapper"),n=r(v.username,e);i.append(n),o.emit("private-message",{from:v,to:x,msg:e}),s(this).val("")}})})}(window,window.io,window.$);